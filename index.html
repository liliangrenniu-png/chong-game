<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å–µå‘œçš„ç™½æ—¥æ¢¦ï¼šç™¾å˜ä¹å›­</title>
    <style>
        /* --- 1. å…¨å±€è®¾ç½®ï¼šæŸ”å’Œã€å¯çˆ± --- */
        :root {
            --theme-pink: #FFCDEA;
            --theme-yellow: #FFF5BA;
            --theme-blue: #A2D2FF;
        }
        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden;
            font-family: "å¹¼åœ†", "Rounded Mplus 1c", cursive;
            background-color: var(--theme-pink);
            user-select: none; cursor: url('https://cdn-icons-png.flaticon.com/32/7459/7459939.png'), auto; /* è‚‰å«å…‰æ ‡ */
        }

        /* æ¿€å…‰ç¬”æ¨¡å¼å…‰æ ‡ */
        body.laser-mode { cursor: none; }
        #laser-dot {
            position: absolute; width: 15px; height: 15px; background: red; border-radius: 50%;
            box-shadow: 0 0 10px red, 0 0 20px #ff5555; pointer-events: none; z-index: 100; display: none;
            transform: translate(-50%, -50%); mix-blend-mode: screen;
        }

        /* --- 2. å¤šèƒŒæ™¯åˆ‡æ¢ç³»ç»Ÿ --- */
        #bg-layer {
            position: absolute; width: 100%; height: 100%;
            background-size: cover; background-position: center;
            transition: background-image 0.6s ease-in-out, filter 0.6s;
        }
        /* æŸ”å…‰æ°›å›´å±‚ */
        .overlay {
            position: absolute; width: 100%; height: 100%; pointer-events: none;
            background: radial-gradient(circle at center, transparent 50%, rgba(255, 245, 230, 0.4) 100%);
            mix-blend-mode: overlay;
        }

        /* --- 3. ä¸»è§’ï¼šè¶…åŠ¨æ€å°å¥¶çŒ« --- */
        #cat-container {
            position: absolute; left: 50%; top: 55%;
            width: 220px; height: 220px;
            transform: translate(-50%, -50%); z-index: 20;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94); /* å¹³æ»‘ç§»åŠ¨ */
        }

        /* çŒ«å’ªæœ¬ä½“å®¹å™¨ (è´Ÿè´£å‘¼å¸å’Œæ‘‡å¤´) */
        .cat-body-wrap {
            width: 100%; height: 100%; position: relative;
            animation: breathe 3s ease-in-out infinite; /* å‘¼å¸ */
            transform-origin: bottom center;
            transition: transform 0.2s; /* æ‘‡å¤´è¿‡æ¸¡ */
        }

        /* çŒ«å’ªå›¾ç‰‡ */
        #cat-img {
            width: 100%; height: 100%; object-fit: contain;
            filter: drop-shadow(0 10px 20px rgba(0,0,0,0.15));
            /* çœ¨çœ¼åŠ¨ç”» (é€šè¿‡CSSæ»¤é•œæ¨¡æ‹Ÿï¼Œç®€åŒ–å®ç°) */
            animation: blink 4s infinite;
        }

        /* åŠ¨æ€åŠ¨ç”»å®šä¹‰ */
        @keyframes breathe { 0%, 100% { transform: scaleY(1); } 50% { transform: scaleY(1.03); } }
        @keyframes blink { 0%, 48%, 52%, 100% { filter: brightness(1) drop-shadow(0 10px 20px rgba(0,0,0,0.15)); } 50% { filter: brightness(0.8) drop-shadow(0 10px 20px rgba(0,0,0,0.15)); transform: scaleY(0.98); } }
        /* é¢å‘å·¦ä¾§ */
        .face-left { transform: scaleX(-1); }
        /* æ‰‘å’¬åŠ¨ä½œ */
        .pouncing .cat-body-wrap { animation: pounceAnim 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important; }
        @keyframes pounceAnim { 0% { transform: scale(1); } 40% { transform: scale(1.2, 0.8) translateY(20px); } 80% { transform: scale(0.9, 1.1) translateY(-30px); } 100% { transform: scale(1); } }

        /* --- 4. ä¸°å¯Œçš„ UI --- */
        /* é¡¶éƒ¨æ  */
        .top-bar {
            position: absolute; top: 20px; width: 90%; left: 5%; display: flex; justify-content: space-between; z-index: 100;
        }
        .coin-pill {
            background: #FFF; padding: 8px 20px; border-radius: 30px;
            box-shadow: 0 5px 0 var(--theme-yellow); color: #F7B731; font-weight: bold; font-size: 20px;
            border: 3px solid var(--theme-yellow); display: flex; align-items: center;
        }
        
        /* é¡¶éƒ¨åŠŸèƒ½æŒ‰é’® */
        .top-btn {
            background: #FFF; padding: 10px 15px; border-radius: 20px;
            box-shadow: 0 5px 0 #eee; border: 3px solid #fff;
            cursor: pointer; font-weight: bold; color: #666; transition: 0.1s;
            display: flex; align-items: center; gap: 5px;
        }
        .top-btn:active { transform: translateY(5px); box-shadow: none; }
        #gacha-btn.disabled { filter: grayscale(1); opacity: 0.7; cursor: not-allowed; }

        /* åº•éƒ¨è¶…å¤šæŒ‰é”®æ  */
        #dock {
            position: absolute; bottom: 25px; width: 100%;
            display: flex; justify-content: center; gap: 12px; z-index: 100;
        }
        .dock-btn {
            width: 65px; height: 65px; border-radius: 22px; background: #fff;
            display: flex; font-size: 30px; align-items: center; justify-content: center;
            box-shadow: 0 6px 0 var(--theme-pink), 0 10px 15px rgba(0,0,0,0.1);
            cursor: pointer; transition: 0.1s; border: 3px solid var(--theme-pink); position: relative;
        }
        .dock-btn:active { transform: translateY(6px); box-shadow: 0 0 0 var(--theme-pink); }
        .dock-btn.active-laser { background: #ffadad; border-color: red; box-shadow: 0 6px 0 #c0392b; }

        /* äº’åŠ¨é“å…·æµ®ç° */
        .toy-pop {
            position: absolute; font-size: 50px; z-index: 15; pointer-events: none;
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes popIn { from { transform: translate(-50%, -50%) scale(0); } to { transform: translate(-50%, -50%) scale(1); } }

        /* ç‰¹æ•ˆæ–‡å­— */
        .pop-text {
            position: absolute; font-weight: bold; color: #fff; font-size: 24px;
            pointer-events: none; animation: floatUp 1s forwards; z-index: 200;
            text-shadow: 2px 2px 0 rgba(0,0,0,0.2);
        }
        @keyframes floatUp { 0% { transform: translateY(0) scale(0.8); opacity: 1; } 100% { transform: translateY(-80px) scale(1.2); opacity: 0; } }

    </style>
</head>
<body>

    <div id="bg-layer"></div>
    <div class="overlay"></div>
    <div id="laser-dot"></div>

    <div class="top-bar">
        <div class="coin-pill">ğŸ’° <span id="coin-count">0</span></div>
        <div style="display: flex; gap: 10px;">
            <div class="top-btn" onclick="switchBG()" style="background: var(--theme-blue);">ğŸ¨ æ¢åœºæ™¯</div>
            <div class="top-btn disabled" id="gacha-btn" onclick="gachaCat()" style="background: var(--theme-pink); color: white;">ğŸ 10é‡‘å¸æ¢çŒ«</div>
        </div>
    </div>

    <div id="cat-container" onclick="petCat(event)">
        <div class="cat-body-wrap" id="cat-wrap">
            <img id="cat-img" src="" alt="Cute Cat">
        </div>
    </div>

    <div id="dock">
        <div class="dock-btn" id="laser-dock-btn" onclick="toggleLaser()">ğŸ”´</div>
        <div class="dock-btn" onclick="interact('ğŸŸ', 'yummy')">ğŸŸ</div>
        <div class="dock-btn" onclick="interact('ğŸ§¶', 'play')">ğŸ§¶</div>
        <div class="dock-btn" onclick="interact('ğŸ§¸', 'hug')">ğŸ§¸</div>
        <div class="dock-btn" style="font-size: 36px;" onclick="interact('ğŸ›', 'bath')">ğŸ›</div>
    </div>

<script>
    let coins = 0;
    let isLaserMode = false;
    let isBusy = false;
    const catContainer = document.getElementById('cat-container');
    const catWrap = document.getElementById('cat-wrap');
    const catImg = document.getElementById('cat-img');
    const bgLayer = document.getElementById('bg-layer');
    const coinLabel = document.getElementById('coin-count');
    const gachaBtn = document.getElementById('gacha-btn');
    const laserDot = document.getElementById('laser-dot');

    // --- 1. ç´ æåº“ (ä¿è¯å¯çˆ±å’Œå¤šæ ·) ---
    const cats = [
        'https://cdn-icons-png.flaticon.com/512/10309/10309451.png', // æ©˜ç™½
        'https://cdn-icons-png.flaticon.com/512/10309/10309452.png', // ä¸‰èŠ±
        'https://cdn-icons-png.flaticon.com/512/10309/10309332.png', // ç°ç™½
        'https://cdn-icons-png.flaticon.com/512/10309/10309368.png', // å¥¶ç‰›
        'https://cdn-icons-png.flaticon.com/512/10309/10309399.png'  // çº¯ç™½
    ];
    let catIdx = 0;

    const bgs = [
        'https://img.freepik.com/free-vector/hand-drawn-kawaii-room-interior_23-2150654503.jpg', // é˜³å…‰æˆ¿é—´
        'https://img.freepik.com/free-vector/hand-drawn-kawaii-sky-background_23-2150633476.jpg', // äº‘æœµåŸå ¡
        'https://img.freepik.com/free-vector/hand-drawn-kawaii-garden-background_23-2150633480.jpg', // ç§˜å¯†èŠ±å›­
        'https://img.freepik.com/free-vector/hand-drawn-cozy-winter-background_23-2150658229.jpg' // æš–æš–è¢«çª
    ];
    let bgIdx = 0;

    // --- åˆå§‹åŒ– ---
    function init() {
        catImg.src = cats[catIdx];
        bgLayer.style.backgroundImage = `url('${bgs[bgIdx]}')`;
        updateUI();
    }

    // --- æ ¸å¿ƒï¼šåŠ¨æ€æ„Ÿ (å¤´éƒ¨è·Ÿéšé¼ æ ‡) ---
    document.addEventListener('mousemove', (e) => {
        if (isLaserMode) {
            laserDot.style.left = e.clientX + 'px';
            laserDot.style.top = e.clientY + 'px';
            if (!isBusy) chase(e.clientX, e.clientY); // æ¿€å…‰æ¨¡å¼ä¸‹è¿½é€
        }

        // ç®€å•çš„å¤´éƒ¨è·Ÿéšæ•ˆæœ (é€šè¿‡è½»å¾®æ—‹è½¬èº«ä½“æ¨¡æ‹Ÿ)
        if (!isBusy) {
            const rect = catContainer.getBoundingClientRect();
            const catX = rect.left + rect.width / 2;
            // è®¡ç®—é¼ æ ‡ç›¸å¯¹äºçŒ«å’ªçš„æ°´å¹³ä½ç½®ï¼Œäº§ç”Ÿ -15deg åˆ° 15deg çš„æ—‹è½¬
            let rotate = (e.clientX - catX) / window.innerWidth * 30;
            rotate = Math.max(-15, Math.min(15, rotate)); // é™åˆ¶è§’åº¦
            catWrap.style.transform = `rotate(${rotate}deg)`;
            
            // é¢å‘åˆ¤æ–­
            if (e.clientX < catX) catContainer.classList.add('face-left');
            else catContainer.classList.remove('face-left');
        }
    });

    // --- ç©æ³•1ï¼šåˆ‡æ¢èƒŒæ™¯ ---
    function switchBG() {
        bgIdx = (bgIdx + 1) % bgs.length;
        bgLayer.style.filter = 'blur(10px) brightness(1.2)'; // åˆ‡æ¢æ—¶çš„æ¨¡ç³Šç‰¹æ•ˆ
        setTimeout(() => {
            bgLayer.style.backgroundImage = `url('${bgs[bgIdx]}')`;
            bgLayer.style.filter = '';
            spawnPopText('ğŸ¨ åœºæ™¯åˆ‡æ¢!', window.innerWidth/2, window.innerHeight/2);
        }, 300);
    }

    // --- ç©æ³•2ï¼š10é‡‘å¸æŠ½çŒ« ---
    function gachaCat() {
        if (coins < 10) return;
        coins -= 10; updateUI();
        
        let newIdx;
        do { newIdx = Math.floor(Math.random() * cats.length); } while (newIdx === catIdx);
        catIdx = newIdx;

        catContainer.style.transform = 'translate(-50%, -50%) scale(0)'; // ç¼©å°æ¶ˆå¤±
        setTimeout(() => {
            catImg.src = cats[catIdx];
            catContainer.style.transform = 'translate(-50%, -50%) scale(1)'; // æ”¾å¤§å‡ºç°
            spawnPopText('âœ¨ æ–°çŒ«å’ªé©¾åˆ°!', window.innerWidth/2, window.innerHeight/2 + 100);
        }, 300);
    }

    // --- ç©æ³•3ï¼šæ¿€å…‰ç¬”æ¨¡å¼ (æœ€å¥½ç©!) ---
    function toggleLaser() {
        isLaserMode = !isLaserMode;
        document.body.classList.toggle('laser-mode', isLaserMode);
        laserDot.style.display = isLaserMode ? 'block' : 'none';
        document.getElementById('laser-dock-btn').classList.toggle('active-laser', isLaserMode);
        // æ¿€å…‰æ¨¡å¼ä¸‹ç§»åŠ¨æ›´å¿«
        catContainer.style.transitionDuration = isLaserMode ? '0.15s' : '0.3s';
        if (!isLaserMode) resetCatPos();
    }

    // --- ç©æ³•4ï¼šåº•éƒ¨ç©å…·äº’åŠ¨ ---
    function interact(toy, actionType) {
        if (isBusy || isLaserMode) return;
        isBusy = true;
        coins += 5; updateUI();

        // 1. ç”Ÿæˆç©å…·
        const toyEl = document.createElement('div');
        toyEl.className = 'toy-pop'; toyEl.innerText = toy;
        // åœ¨çŒ«å’ªå‰æ–¹ç”Ÿæˆ
        const rect = catContainer.getBoundingClientRect();
        const targetX = rect.left + rect.width/2 + (Math.random()-0.5)*100;
        const targetY = rect.top + rect.height/2 + 50;
        toyEl.style.left = targetX + 'px'; toyEl.style.top = targetY + 'px';
        document.body.appendChild(toyEl);

        // 2. çŒ«å’ªç§»åŠ¨è¿‡å»
        catContainer.style.left = targetX + 'px';
        catContainer.style.top = targetY - 40 + 'px';

        // 3. æ‰§è¡ŒåŠ¨ä½œåŠ¨ç”»
        setTimeout(() => {
            catContainer.classList.add('pouncing'); // é€šç”¨æ‰‘å’¬åŠ¨ä½œ
            let msg = toy === 'ğŸŸ' ? 'ğŸ˜‹ å§å”§å§å”§!' : (toy === 'ğŸ›' ? 'ğŸ«§ å¥½èˆ’æœ!' : 'ğŸ’– å¥½ç©!');
            spawnPopText(msg, targetX, targetY - 80);
            
            setTimeout(() => {
                catContainer.classList.remove('pouncing');
                toyEl.remove();
                isBusy = false;
                resetCatPos(); // å›åˆ°ä¸­å¿ƒ
            }, 1000);
        }, 300);
    }
    
    // æ™®é€šæŠšæ‘¸
    function petCat(e) {
        if (isBusy || isLaserMode) return;
        coins++; updateUI();
        spawnPopText('â¤ï¸', e.clientX, e.clientY - 50);
        // Qå¼¹åé¦ˆ
        catWrap.style.transform = 'scale(1.1, 0.9)';
        setTimeout(() => catWrap.style.transform = '', 200);
    }

    // è¾…åŠ©å‡½æ•°
    function chase(x, y) {
        catContainer.style.left = x + 'px';
        catContainer.style.top = y + 'px';
    }
    function resetCatPos() {
        catContainer.style.left = '50%';
        catContainer.style.top = '55%';
        catWrap.style.transform = '';
    }
    function updateUI() {
        coinLabel.innerText = coins;
        gachaBtn.classList.toggle('disabled', coins < 10);
    }
    function spawnPopText(text, x, y) {
        const p = document.createElement('div'); p.className = 'pop-text'; p.innerText = text;
        p.style.left = x + 'px'; p.style.top = y + 'px';
        document.body.appendChild(p); setTimeout(() => p.remove(), 1000);
    }

    init();
</script>
</body>
</html>
