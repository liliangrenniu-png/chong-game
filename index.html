<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ä¹Ÿæ˜¯çŒ«å’ªå‘€ï¼šå¡é€šèŒå® å±‹</title>
    <style>
        /* --- 1. å¡é€šé£æ ¼å…¨å±€è®¾ç½® --- */
        :root {
            --theme-color: #FF9A9E;
            --coin-color: #FFD700;
        }
        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            overflow: hidden;
            font-family: "å¹¼åœ†", "Microsoft YaHei", cursive;
            background-color: #FFF5E6;
            user-select: none;
        }

        /* --- 2. å¡é€šæ¸©é¦¨èƒŒæ™¯ --- */
        #game-stage {
            position: relative; width: 100%; height: 100%;
            /* ä½¿ç”¨æ˜äº®çš„å¡é€šå®¢å…èƒŒæ™¯ */
            background: url('https://img.freepik.com/free-vector/cartoon-living-room-interior-house-with-couch-window_107791-17174.jpg') no-repeat center center;
            background-size: cover;
        }
        
        /* æŸ”å…‰æ»¤é•œ */
        .overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 255, 230, 0.3);
            pointer-events: none;
        }

        /* --- 3. UI ç•Œé¢ --- */
        /* é¡¶éƒ¨é‡‘å¸æ  */
        #top-bar {
            position: absolute; top: 20px; left: 20px; z-index: 100;
            background: #FFF; padding: 10px 25px; border-radius: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1); font-weight: bold; color: #555;
            display: flex; align-items: center; font-size: 20px;
            border: 3px solid var(--theme-color);
        }
        .coin-icon { color: var(--coin-color); margin-right: 8px; font-size: 24px; }

        /* æŠ½å¡å¤§æŒ‰é’® (æ ¸å¿ƒåŠŸèƒ½) */
        #gacha-btn {
            position: absolute; top: 20px; right: 20px; z-index: 100;
            background: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%);
            color: white; padding: 12px 20px; border-radius: 30px;
            font-weight: bold; cursor: pointer;
            box-shadow: 0 5px 15px rgba(161, 140, 209, 0.4);
            border: 3px solid #fff; transition: 0.2s;
            display: flex; flex-direction: column; align-items: center;
        }
        #gacha-btn:active { transform: scale(0.95); }
        #gacha-btn.disabled { filter: grayscale(1); opacity: 0.7; cursor: not-allowed; }
        .gacha-price { font-size: 12px; opacity: 0.9; }

        /* åº•éƒ¨äº’åŠ¨æ  */
        #bottom-dock {
            position: absolute; bottom: 30px; width: 100%;
            display: flex; justify-content: center; gap: 20px; z-index: 100;
        }
        .action-btn {
            width: 70px; height: 70px; border-radius: 25px; background: #fff;
            display: flex; font-size: 35px; align-items: center; justify-content: center;
            box-shadow: 0 8px 0 #FFD1DC, 0 15px 20px rgba(0,0,0,0.1);
            cursor: pointer; transition: 0.1s; border: 2px solid var(--theme-color);
        }
        .action-btn:active { transform: translateY(8px); box-shadow: 0 0 0 #FFD1DC; }

        /* --- 4. ä¸»è§’ï¼šå¤šå˜çš„å¯çˆ±å¡é€šçŒ« --- */
        #cat-container {
            position: absolute; 
            left: 50%; bottom: 120px;
            transform: translateX(-50%);
            width: 280px; height: 280px;
            z-index: 10;
            cursor: grab;
        }

        /* çŒ«å’ªå›¾ç‰‡å®¹å™¨ */
        .cat-img {
            width: 100%; height: 100%;
            object-fit: contain;
            filter: drop-shadow(0 10px 15px rgba(0,0,0,0.2));
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        /* æŠšæ‘¸æ—¶çš„åŠ¨ç”» */
        .cat-img.rubbing { animation: happy-shake 0.5s infinite; }
        @keyframes happy-shake { 0%, 100% { transform: rotate(0); } 25% { transform: rotate(3deg); } 75% { transform: rotate(-3deg); } }

        /* --- 5. ç‰¹æ•ˆä¸æ¼‚æµ®ç‰© --- */
        /* å¿ƒæƒ…æ°”æ³¡ */
        #mood-bubble {
            position: absolute; top: -60px; right: -20px;
            background: #fff; padding: 10px 15px; border-radius: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1); font-size: 24px;
            opacity: 0; transition: 0.3s; transform: scale(0.8);
        }
        #mood-bubble::after {
            content: ''; position: absolute; bottom: -10px; left: 20px;
            border-width: 10px 10px 0; border-style: solid; border-color: #fff transparent;
        }
        #mood-bubble.show { opacity: 1; transform: scale(1); }

        /* é£å‡ºçš„æ¯›çº¿çƒ */
        .toy-yarn {
            position: absolute; font-size: 50px; z-index: 5;
            animation: fly-yarn 1.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
        }
        @keyframes fly-yarn {
            0% { left: -50px; top: 80%; transform: rotate(0deg); }
            100% { left: 120%; top: 40%; transform: rotate(720deg); }
        }

        /* é‡‘å¸/çˆ±å¿ƒçˆ†å‡ºç‰¹æ•ˆ */
        .pop-fx {
            position: absolute; font-size: 28px; font-weight: bold; color: var(--theme-color);
            text-shadow: 1px 1px 0 #fff; pointer-events: none; z-index: 50;
            animation: pop-up 1s forwards;
        }
        @keyframes pop-up { 0% { transform: translateY(0) scale(0.5); opacity: 1; } 100% { transform: translateY(-100px) scale(1.2); opacity: 0; } }
        
        /* åˆ‡æ¢çŒ«å’ªæ—¶çš„çƒŸé›¾ */
        .poof-fx {
            position: absolute; left: 50%; bottom: 120px; transform: translateX(-50%) scale(0);
            font-size: 150px; opacity: 0.8; z-index: 15; pointer-events: none;
        }
        @keyframes poof { 0% { transform: translateX(-50%) scale(0.5); opacity: 1; } 100% { transform: translateX(-50%) scale(1.5); opacity: 0; } }

    </style>
</head>
<body>

<div id="game-stage">
    <div class="overlay"></div>

    <div id="top-bar">
        <span class="coin-icon">ğŸ’°</span> 
        <span id="coin-count">0</span>
    </div>
    
    <div id="gacha-btn" onclick="adoptNewCat()" class="disabled">
        <div>ğŸ å¬å”¤æ–°èŒå® </div>
        <div class="gacha-price">(éœ€è¦ 10 é‡‘å¸)</div>
    </div>

    <div id="cat-container" onclick="petCat()">
        <div id="mood-bubble">â¤ï¸</div>
        <img id="current-cat-img" class="cat-img" src="" alt="Cute Cat">
    </div>
    
    <div id="fx-container"></div>

    <div id="bottom-dock">
        <div class="action-btn" onclick="playYarn()">ğŸ§¶</div>
        <div class="action-btn" onclick="giveTreat()">ğŸŸ</div>
    </div>
</div>

<script>
    let coins = 0;
    // --- å¯çˆ±å¡é€šçŒ«å’ªå›¾åº“ ---
    // è¿™é‡Œç²¾é€‰äº†å‡ å¼ é£æ ¼ç»Ÿä¸€ã€éå¸¸å¯çˆ±çš„å¡é€šçŒ«å’ªå›¾ç‰‡
    const catLibrary = [
        'https://cdn-icons-png.flaticon.com/512/1864/1864514.png', // æ©˜çŒ«
        'https://cdn-icons-png.flaticon.com/512/1864/1864509.png', // ç°ç™½çŒ«
        'https://cdn-icons-png.flaticon.com/512/1864/1864499.png', // ä¸‰èŠ±çŒ«
        'https://cdn-icons-png.flaticon.com/512/1864/1864524.png', // æš¹ç½—çŒ«
        'https://cdn-icons-png.flaticon.com/512/1864/1864476.png', // ç¾çŸ­
        'https://cdn-icons-png.flaticon.com/512/1864/1864504.png'  // èµ·å¸çŒ«
    ];
    let currentCatIdx = 0;

    const catImg = document.getElementById('current-cat-img');
    const coinLabel = document.getElementById('coin-count');
    const gachaBtn = document.getElementById('gacha-btn');
    const moodBubble = document.getElementById('mood-bubble');

    // åˆå§‹åŒ–
    function init() {
        // é»˜è®¤æ˜¾ç¤ºç¬¬ä¸€åª
        catImg.src = catLibrary[currentCatIdx];
        updateUI();
        // å¯åŠ¨éšæœºå¿ƒæƒ…
        setInterval(randomMood, 5000);
    }

    // æ›´æ–°UIçŠ¶æ€
    function updateUI() {
        coinLabel.innerText = coins;
        // å¦‚æœé‡‘å¸å¤§äº10ï¼Œæ¿€æ´»æŠ½å¡æŒ‰é’®
        if (coins >= 10) {
            gachaBtn.classList.remove('disabled');
        } else {
            gachaBtn.classList.add('disabled');
        }
    }

    // å¢åŠ é‡‘å¸å¹¶æ˜¾ç¤ºç‰¹æ•ˆ
    function addCoins(amount, x, y) {
        coins += amount;
        updateUI();
        spawnPopFX(`+${amount}`, x, y);
    }

    // --- æ ¸å¿ƒç©æ³•ï¼š10é‡‘å¸æŠ½æ–°çŒ« ---
    function adoptNewCat() {
        if (coins < 10) {
            showBubble('ğŸ’¸ é‡‘å¸ä¸å¤Ÿå•¦...');
            return;
        }

        coins -= 10;
        updateUI();

        // æ’­æ”¾çƒŸé›¾ç‰¹æ•ˆ
        spawnPoofFX();

        // éšæœºé€‰æ‹©ä¸€åªä¸ä¸€æ ·çš„æ–°çŒ«
        let newIdx;
        do {
            newIdx = Math.floor(Math.random() * catLibrary.length);
        } while (newIdx === currentCatIdx && catLibrary.length > 1);
        
        currentCatIdx = newIdx;

        // åˆ‡æ¢å›¾ç‰‡å¹¶æ’­æ”¾å‡ºç°åŠ¨ç”»
        setTimeout(() => {
            catImg.src = catLibrary[currentCatIdx];
            catImg.style.transform = 'scale(0)';
            setTimeout(() => {
                catImg.style.transform = 'scale(1)';
                showBubble('âœ¨ æ–°æœ‹å‹ç™»åœº!');
                spawnPopFX('ğŸ’–ğŸ’–ğŸ’–', window.innerWidth/2, window.innerHeight/2);
            }, 100);
        }, 200);
    }

    // äº’åŠ¨1ï¼šæŠšæ‘¸ç‚¹å‡»
    function petCat(e) {
        // ç‚¹å‡»æ—¶Qå¼¹ä¸€ä¸‹
        catImg.style.transform = 'scale(1.1, 0.9)';
        setTimeout(() => catImg.style.transform = 'scale(1)', 150);
        
        // å¥–åŠ±é‡‘å¸
        addCoins(1, event.clientX, event.clientY);
        showBubble('å‘¼å™œå™œ~');
    }

    // äº’åŠ¨2ï¼šæ‰”æ¯›çº¿çƒ
    function playYarn() {
        addCoins(5, window.innerWidth/2, window.innerHeight/2);
        showBubble('ğŸ§¶ å¥½ç©!');
        
        let yarn = document.createElement('div');
        yarn.className = 'toy-yarn';
        yarn.innerText = 'ğŸ§¶';
        document.getElementById('game-stage').appendChild(yarn);
        setTimeout(() => yarn.remove(), 1500);

        // çŒ«å’ªè·³èµ·æ¥çœ‹
        catImg.style.transform = 'translateY(-30px) rotate(5deg)';
        setTimeout(() => catImg.style.transform = 'translateY(0) rotate(0)', 500);
    }

    // äº’åŠ¨3ï¼šå–‚å°é±¼å¹²
    function giveTreat() {
        addCoins(3, window.innerWidth/2, window.innerHeight/2);
        showBubble('ğŸŸ å§å”§å§å”§!');
        spawnPopFX('ğŸ˜‹', window.innerWidth/2, window.innerHeight/2 - 100);
        
        // çŒ«å’ªå¼€å¿ƒæ‘‡æ‘†
        catImg.classList.add('rubbing');
        setTimeout(() => catImg.classList.remove('rubbing'), 1000);
    }

    // ç‰¹æ•ˆï¼šéšæœºå¿ƒæƒ…
    function randomMood() {
        const moods = ['ğŸ’¤', 'ğŸ’­', 'ğŸŸ', 'ğŸ§¶', 'â¤ï¸', 'âœ¨'];
        if (Math.random() > 0.7) {
            showBubble(moods[Math.floor(Math.random() * moods.length)]);
        }
    }

    // å·¥å…·ï¼šæ˜¾ç¤ºæ°”æ³¡
    let bubbleTimer;
    function showBubble(text) {
        moodBubble.innerText = text;
        moodBubble.classList.add('show');
        clearTimeout(bubbleTimer);
        bubbleTimer = setTimeout(() => moodBubble.classList.remove('show'), 2000);
    }

    // å·¥å…·ï¼šå¼¹å‡ºæ–‡å­—ç‰¹æ•ˆ
    function spawnPopFX(text, x, y) {
        let fx = document.createElement('div');
        fx.className = 'pop-fx';
        fx.innerText = text;
        fx.style.left = x + 'px';
        fx.style.top = y + 'px';
        document.getElementById('fx-container').appendChild(fx);
        setTimeout(() => fx.remove(), 1000);
    }

    // å·¥å…·ï¼šåˆ‡æ¢çƒŸé›¾ç‰¹æ•ˆ
    function spawnPoofFX() {
        let poof = document.createElement('div');
        poof.className = 'poof-fx';
        poof.innerText = 'ğŸ’¨';
        poof.style.animation = 'poof 0.5s forwards';
        document.getElementById('fx-container').appendChild(poof);
        setTimeout(() => poof.remove(), 500);
    }

    init();

</script>
</body>
</html>
