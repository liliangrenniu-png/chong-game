<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>æ¢¦å¹»å–µçµï¼šå¤šçŒ«ä¹å›­</title>
    <style>
        :root { --main-gold: #ffd700; }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; font-family: "Microsoft YaHei"; background: #222; }

        /* --- æ¢¦å¹»åœºæ™¯è®¾è®¡ --- */
        #game-world { width: 100vw; height: 100vh; position: relative; transition: 0.8s; overflow: hidden; }
        
        /* å¨æˆ¿ï¼šå¸¦ç¶å°å’Œæ©±æŸœ */
        .kitchen { background: #ffbe76; }
        .kitchen::before { content: "ğŸ³ ç¶å° _________ [ ğŸ´ æ©±æŸœ ]"; position: absolute; top: 100px; width: 100%; text-align: center; font-size: 30px; color: rgba(0,0,0,0.1); font-weight: bold; }

        /* æµ´å®¤ï¼šå¸¦æµ´ç¼¸ */
        .bathroom { background: #81ecec; }
        .bathroom::before { content: "ğŸ› ~~~~~ æµ´ç¼¸ ~~~~~"; position: absolute; bottom: 50px; width: 100%; text-align: center; font-size: 40px; color: rgba(255,255,255,0.4); }

        /* å§å®¤ï¼šå¸¦å¤§åºŠ */
        .bedroom { background: #a29bfe; }
        .bedroom::before { content: "ğŸ›ï¸ [========= æ¢¦å¹»å¤§åºŠ =========]"; position: absolute; top: 200px; width: 100%; text-align: center; font-size: 30px; color: rgba(255,255,255,0.3); }

        /* --- å®Œæ•´çš„çŒ«å’ªï¼ˆé­”å…½é£æ ¼ï¼‰ --- */
        .cat-entity {
            position: absolute; width: 100px; height: 80px;
            transition: left 1s ease-out, top 1s ease-out;
            cursor: pointer; z-index: 10; transform-origin: center;
        }
        .cat-body {
            position: absolute; width: 60px; height: 35px;
            background: #ffa502; border-radius: 40px; bottom: 10px; left: 20px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2); transition: 0.3s;
        }
        .cat-head {
            position: absolute; font-size: 45px; top: -10px; left: 10px;
            z-index: 5; transition: 0.3s;
        }
        .cat-tail {
            position: absolute; width: 30px; height: 10px;
            background: #e67e22; right: 0; bottom: 25px;
            border-radius: 5px; transform-origin: left;
            animation: tailWag 1s infinite alternate;
        }
        .cat-leg {
            position: absolute; width: 8px; height: 15px;
            background: #e67e22; bottom: 0; border-radius: 4px;
        }
        .leg-1 { left: 30px; } .leg-2 { left: 50px; }

        @keyframes tailWag { from { transform: rotate(-20deg); } to { transform: rotate(20deg); } }

        /* --- æ¢¦å¹»é‡‘å¸ä¸é£Ÿç‰© --- */
        .gold-coin {
            position: absolute; font-size: 25px; color: var(--main-gold);
            text-shadow: 0 0 10px white; animation: coinFloat 1s forwards;
        }
        @keyframes coinFloat { to { transform: translateY(-100px); opacity: 0; } }

        .fish-food { position: absolute; font-size: 30px; transition: 0.5s; z-index: 5; }

        /* --- UIä¸å­µåŒ–å™¨ --- */
        #ui { position: absolute; top: 20px; left: 20px; z-index: 100; color: white; background: rgba(0,0,0,0.4); padding: 15px; border-radius: 15px; }
        
        #hatcher {
            position: absolute; bottom: 20px; right: 20px; cursor: pointer;
            width: 100px; height: 100px; background: radial-gradient(#fff, #ff9ff3);
            border-radius: 50% 50% 10% 10%; border: 4px solid white;
            display: flex; align-items: center; justify-content: center; font-size: 40px;
            box-shadow: 0 0 20px #ff9ff3; z-index: 100;
        }

        .btn-panel { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); display: flex; gap: 10px; }
        button { padding: 10px 20px; border-radius: 20px; border: none; cursor: pointer; font-weight: bold; background: white; }
    </style>
</head>
<body>

<div id="game-world" class="kitchen">
    <div id="ui">
        <div>âœ¨ æ¢¦å¹»é‡‘å¸: <span id="coin-val">20</span></div>
        <div id="scene-info">ğŸ“ å½“å‰ï¼šæ¢¦å¹»å¨æˆ¿</div>
    </div>

    <div id="hatcher" onclick="hatchNewCat()">ğŸŒ¸</div>

    <div class="btn-panel">
        <button onclick="throwFood()">ğŸŸ æ‰”å°é±¼å¹²</button>
        <button onclick="unlockNext()">ğŸ”“ è§£é”æ–°åœºæ™¯ (6é‡‘)</button>
        <button onclick="healCats()">ğŸ’Š æ•´ä½“æ²»ç–—</button>
    </div>
</div>

<script>
    let coins = 20;
    let cats = [];
    const world = document.getElementById('game-world');
    const scenes = [
        { name: 'æ¢¦å¹»å¨æˆ¿', class: 'kitchen' },
        { name: 'æ˜Ÿå…‰æµ´å®¤', class: 'bathroom' },
        { name: 'äº‘æœµå§å®¤', class: 'bedroom' }
    ];
    let currentSceneIdx = 0;

    class Cat {
        constructor(id) {
            this.id = id;
            this.x = Math.random() * (window.innerWidth - 100);
            this.y = Math.random() * (window.innerHeight - 150) + 100;
            this.isSleeping = false;
            this.color = `hsl(${Math.random() * 360}, 80%, 60%)`;
            this.createDOM();
            this.startAI();
        }

        createDOM() {
            this.el = document.createElement('div');
            this.el.className = 'cat-entity';
            this.el.innerHTML = `
                <div class="cat-head">ğŸ±</div>
                <div class="cat-body" style="background:${this.color}"></div>
                <div class="cat-tail" style="background:${this.color}"></div>
                <div class="cat-leg leg-1" style="background:${this.color}"></div>
                <div class="cat-leg leg-2" style="background:${this.color}"></div>
            `;
            this.el.onclick = (e) => this.onClicked(e);
            world.appendChild(this.el);
            this.updatePos();
        }

        updatePos() {
            this.el.style.left = this.x + 'px';
            this.el.style.top = this.y + 'px';
        }

        onClicked(e) {
            coins += 1;
            document.getElementById('coin-val').innerText = coins;
            this.jump();
            spawnCoinEffect(e.clientX, e.clientY);
        }

        jump() {
            this.el.style.transform = 'scale(1.2) translateY(-20px)';
            setTimeout(() => this.el.style.transform = 'scale(1)', 200);
        }

        startAI() {
            setInterval(() => {
                if (Math.random() > 0.7 && !this.isSleeping) {
                    this.x += (Math.random() - 0.5) * 200;
                    this.y += (Math.random() - 0.5) * 200;
                    this.x = Math.max(50, Math.min(window.innerWidth - 100, this.x));
                    this.y = Math.max(150, Math.min(window.innerHeight - 100, this.y));
                    this.updatePos();
                }
                // å¶å°”é—­çœ¼
                if (Math.random() > 0.9) {
                    this.el.querySelector('.cat-head').innerText = "ğŸ˜´";
                    this.isSleeping = true;
                    setTimeout(() => {
                        this.el.querySelector('.cat-head').innerText = "ğŸ±";
                        this.isSleeping = false;
                    }, 3000);
                }
            }, 3000);
        }

        moveTo(tx, ty) {
            this.x = tx; this.y = ty;
            this.updatePos();
            this.el.querySelector('.cat-head').innerText = "ğŸ˜‹";
            setTimeout(() => this.el.querySelector('.cat-head').innerText = "ğŸ±", 2000);
        }
    }

    // åˆå§‹ç”Ÿæˆä¸€åªçŒ«
    cats.push(new Cat(0));

    function hatchNewCat() {
        if (coins >= 12) {
            coins -= 12;
            updateUI();
            const c = new Cat(cats.length);
            cats.push(c);
            // å­µåŒ–åŠ¨ç”»
            document.getElementById('hatcher').style.transform = 'scale(1.5)';
            setTimeout(() => document.getElementById('hatcher').style.transform = 'scale(1)', 500);
        }
    }

    function throwFood() {
        const tx = Math.random() * (window.innerWidth - 100);
        const ty = Math.random() * (window.innerHeight - 200) + 100;
        const fish = document.createElement('div');
        fish.className = 'fish-food';
        fish.innerText = 'ğŸŸ';
        fish.style.left = tx + 'px';
        fish.style.top = ty + 'px';
        world.appendChild(fish);

        // è®©æœ€è¿‘çš„ä¸€åªçŒ«è·‘è¿‡å»åƒ
        setTimeout(() => {
            if(cats.length > 0) {
                cats[0].moveTo(tx, ty);
                setTimeout(() => {
                    fish.remove();
                    coins += 5;
                    updateUI();
                }, 1000);
            }
        }, 500);
    }

    function unlockNext() {
        if (coins >= 6) {
            coins -= 6;
            currentSceneIdx = (currentSceneIdx + 1) % scenes.length;
            world.className = scenes[currentSceneIdx].class;
            document.getElementById('scene-info').innerText = "ğŸ“ å½“å‰ï¼š" + scenes[currentSceneIdx].name;
            updateUI();
        }
    }

    function spawnCoinEffect(x, y) {
        const c = document.createElement('div');
        c.className = 'gold-coin';
        c.innerText = 'âœ¨';
        c.style.left = x + 'px';
        c.style.top = y + 'px';
        document.body.appendChild(c);
        setTimeout(() => c.remove(), 1000);
    }

    function updateUI() {
        document.getElementById('coin-val').innerText = coins;
    }

    function healCats() {
        alert("ä½¿ç”¨äº†æ¢¦å¹»è¯æ°´ï¼æ‰€æœ‰çš„å–µçµéƒ½æ¢å¤äº†å¥åº·å’Œé¥±å’Œåº¦ï¼");
        cats.forEach(c => c.el.style.filter = 'saturate(1.5)');
    }
</script>
</body>
</html>
