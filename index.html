<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¹»å¢ƒçŒ«çµï¼šç™¾å˜é­”æ³•å±‹</title>
    <style>
        /* --- 1. å…¨å±€ä¸åœºæ™¯ --- */
        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden;
            font-family: "å¹¼åœ†", "Rounded Mplus 1c", cursive;
            background-color: #2c1e3b;
            transition: background-image 0.5s ease-in-out;
            background-size: cover; background-position: center;
            cursor: url('https://cdn-icons-png.flaticon.com/32/9921/9921170.png'), auto; /* é­”æ³•æ£’å…‰æ ‡ */
            user-select: none;
        }

        /* èƒŒæ™¯è¦†ç›–å±‚ï¼ˆå¢åŠ é­”æ³•æ°›å›´ï¼‰ */
        .bg-overlay {
            position: absolute; width: 100%; height: 100%;
            background: radial-gradient(circle at center, transparent 0%, rgba(0,0,0,0.6) 100%);
            pointer-events: none;
        }
        
        /* æ¼‚æµ®çš„é­”æ³•å°˜åŸƒ */
        .magic-dust {
            position: absolute; width: 4px; height: 4px; background: #fff; border-radius: 50%;
            box-shadow: 0 0 10px #fff, 0 0 20px var(--glow-color);
            opacity: 0.6; animation: floatUp 10s linear infinite;
        }
        @keyframes floatUp { from { transform: translateY(100vh) scale(0.5); opacity: 0; } to { transform: translateY(-10vh) scale(1.5); opacity: 0.8; } }

        /* --- 2. ä¸»è§’ï¼šç™¾å˜ç²¾çµçŒ« --- */
        #cat-container {
            position: absolute; left: 50%; top: 50%;
            width: 180px; height: 180px;
            transform: translate(-50%, -50%);
            transform-origin: center center;
            transition: left 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94), top 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            z-index: 20; cursor: pointer;
        }

        /* ç²¾çµç¿…è†€ */
        .wings-wrap {
            position: absolute; top: 30%; left: -10%; width: 120%; height: 50%;
            display: flex; justify-content: space-between; z-index: -1;
            filter: drop-shadow(0 0 10px var(--glow-color));
            opacity: 0.9; mix-blend-mode: screen;
        }
        .wing {
            width: 60px; height: 90px;
            /* ä½¿ç”¨åŠé€æ˜çš„ç¿…è†€ç´ æ */
            background-image: url('https://cdn-icons-png.flaticon.com/512/9373/9373775.png');
            background-size: contain; background-repeat: no-repeat;
        }
        .wing.left { transform-origin: right center; animation: flapL 0.15s infinite alternate; }
        .wing.right { transform: scaleX(-1); transform-origin: left center; animation: flapR 0.15s infinite alternate; }
        @keyframes flapL { from { transform: rotate(15deg) scaleY(1); } to { transform: rotate(-25deg) scaleY(0.8); } }
        @keyframes flapR { from { transform: scaleX(-1) rotate(15deg) scaleY(1); } to { transform: scaleX(-1) rotate(-25deg) scaleY(0.8); } }

        /* çŒ«å’ªæœ¬ä½“å›¾ç‰‡ */
        #cat-img {
            width: 100%; height: 100%;
            object-fit: contain;
            /* æ‚¬æµ®åŠ¨ç”» + é­”æ³•å…‰æ™• */
            animation: hover 2s ease-in-out infinite;
            filter: drop-shadow(0 0 20px var(--glow-color));
            transition: transform 0.2s;
        }
        @keyframes hover { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }

        /* çŠ¶æ€åŠ¨ç”»ç±» */
        .face-left #cat-img { transform: scaleX(-1); } /* å‘å·¦çœ‹ */
        .eating #cat-img { animation: eatAnim 0.5s infinite alternate !important; } /* åƒä¸œè¥¿ */
        @keyframes eatAnim { 0% { transform: translateY(0) rotate(0deg) scale(1); } 100% { transform: translateY(10px) rotate(5deg) scale(0.95); } }
        .playing #cat-img { animation: playAnim 0.4s infinite !important; } /* ç©è€ */
        @keyframes playAnim { 0% { transform: translateX(0) rotate(0); } 25% { transform: translateX(-10px) rotate(-10deg); } 75% { transform: translateX(10px) rotate(10deg); } }
        
        /* ç¬ç§»ç‰¹æ•ˆ */
        .teleport-out { animation: tpOut 0.4s forwards !important; }
        .teleport-in { animation: tpIn 0.4s forwards !important; }
        @keyframes tpOut { to { transform: translate(-50%, -50%) scale(0) rotate(720deg); opacity: 0; filter: brightness(3); } }
        @keyframes tpIn { from { transform: translate(-50%, -50%) scale(2); opacity: 0; filter: brightness(3); } to { transform: translate(-50%, -50%) scale(1); opacity: 1; } }

        /* --- 3. äº’åŠ¨å…ƒç´ ä¸ç‰¹æ•ˆ --- */
        /* æ‹–å°¾ç²’å­ */
        .trail {
            position: absolute; width: 12px; height: 12px; border-radius: 50%;
            background: var(--glow-color); box-shadow: 0 0 15px var(--glow-color);
            pointer-events: none; z-index: 15; mix-blend-mode: screen;
            animation: fadeTrail 0.8s ease-out forwards;
        }
        @keyframes fadeTrail { to { transform: scale(0.1); opacity: 0; } }
        
        /* æ‰è½çš„ç‰©å“ï¼ˆé±¼/çƒï¼‰ */
        .item-drop {
            position: absolute; font-size: 40px; z-index: 18;
            animation: dropIn 0.5s ease-out; filter: drop-shadow(0 0 10px #fff);
        }
        @keyframes dropIn { from { transform: translate(-50%, -50%) scale(2); opacity: 0; } to { transform: translate(-50%, -50%) scale(1); opacity: 1; } }

        /* ç‚¹å‡»çˆ†å‘ç‰¹æ•ˆ */
        .burst-fx {
            position: absolute; font-size: 24px; pointer-events: none; z-index: 30;
            animation: burst 1s ease-out forwards; color: var(--glow-color); text-shadow: 0 0 5px #fff;
        }
        @keyframes burst { 0% { transform: translate(-50%, -50%) scale(0.5); opacity: 1; } 100% { transform: translate(var(--tx), var(--ty)) scale(0) rotate(var(--r)); opacity: 0; } }

        /* --- 4. åº•éƒ¨åŠŸèƒ½æŒ‰é”®æ  --- */
        #dock {
            position: absolute; bottom: 30px; width: 100%;
            display: flex; justify-content: center; gap: 20px; z-index: 100;
        }
        .dock-btn {
            width: 70px; height: 70px; border-radius: 25px;
            background: rgba(255,255,255,0.15); backdrop-filter: blur(10px);
            border: 2px solid rgba(255,255,255,0.5);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            cursor: pointer; transition: 0.2s; color: #fff;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        .dock-btn:hover { transform: translateY(-5px); background: rgba(255,255,255,0.3); box-shadow: 0 15px 30px rgba(0,0,0,0.3), 0 0 20px var(--glow-color); }
        .dock-btn:active { transform: scale(0.95); }
        .btn-icon { font-size: 30px; margin-bottom: 5px; filter: drop-shadow(0 0 5px currentColor); }
        .btn-label { font-size: 12px; font-weight: bold; }

    </style>
</head>
<body>

    <div class="bg-overlay"></div>
    <div id="dust-layer"></div>

    <div id="cat-container" onclick="clickCat(event)">
        <div class="wings-wrap">
            <div class="wing left"></div>
            <div class="wing right"></div>
        </div>
        <img id="cat-img" src="" alt="Magic Cat">
    </div>

    <div id="dock">
        <div class="dock-btn" onclick="changeCatType()">
            <div class="btn-icon">ğŸ”„</div>
            <div class="btn-label">æ¢çŒ«å’ª</div>
        </div>
        <div class="dock-btn" onclick="changeBackground()">
            <div class="btn-icon">ğŸ¨</div>
            <div class="btn-label">æ¢åœºæ™¯</div>
        </div>
        <div class="dock-btn" style="color: #ff9f43;" onclick="dropItem('ğŸŸ', 'eating')">
            <div class="btn-icon">ğŸŸ</div>
            <div class="btn-label">å–‚é£Ÿ</div>
        </div>
        <div class="dock-btn" style="color: #ff6b81;" onclick="dropItem('ğŸ§¶', 'playing')">
            <div class="btn-icon">ğŸ§¶</div>
            <div class="btn-label">ç©çƒ</div>
        </div>
    </div>

<script>
    // --- æ•°æ®é…ç½® ---
    // 1. ç™¾å˜ç²¾çµçŒ«æ•°æ® (ç§ç±», å›¾ç‰‡, å…‰æ™•é¢œè‰²)
    // ä½¿ç”¨äº†é«˜è´¨é‡ã€å¯çˆ±çš„å…¨èº«å¡é€šçŒ«å’ªç´ æ
    const catTypes = [
        { name: 'æ£®ä¹‹çµ', src: 'https://cdn-icons-png.flaticon.com/512/4392/4392469.png', glow: '#55efc4' }, // ç»¿è‰²ç³»
        { name: 'æ˜Ÿä¹‹çµ', src: 'https://cdn-icons-png.flaticon.com/512/4392/4392486.png', glow: '#a29bfe' }, // ç´«è‰²ç³»
        { name: 'ç«ä¹‹çµ', src: 'https://cdn-icons-png.flaticon.com/512/4392/4392520.png', glow: '#ff7675' }, // çº¢è‰²ç³»
        { name: 'é›ªä¹‹çµ', src: 'https://cdn-icons-png.flaticon.com/512/4392/4392504.png', glow: '#74b9ff' }  // è“è‰²ç³»
    ];
    let catIdx = 0;

    // 2. é­”æ³•åœºæ™¯æ•°æ®
    const backgrounds = [
        'https://images.unsplash.com/photo-1518495973542-4542c06a5843?q=80&w=1920&auto=format&fit=crop', // ç¥ç§˜æ£®æ—
        'https://images.unsplash.com/photo-1536599018102-9f803c140fc1?q=80&w=1920&auto=format&fit=crop', // äº‘ç«¯å¤©å®«
        'https://images.unsplash.com/photo-1596303766859-615876789365?q=80&w=1920&auto=format&fit=crop'  // æ°´æ™¶æ´ç©´
    ];
    let bgIdx = 0;

    // --- DOM å…ƒç´  ---
    const catContainer = document.getElementById('cat-container');
    const catImg = document.getElementById('cat-img');
    const root = document.documentElement; // ç”¨äºè®¾ç½® CSS å˜é‡
    let catPos = { x: window.innerWidth / 2, y: window.innerHeight / 2 };
    let targetPos = { x: catPos.x, y: catPos.y };
    let isBusy = false; // æ˜¯å¦æ­£åœ¨å¿™äºåƒ/ç©
    let trailTimer = null;

    // --- åˆå§‹åŒ– ---
    function init() {
        applyCatType();
        applyBackground();
        generateDust();
        gameLoop(); // å¯åŠ¨æ¸¸æˆå¾ªç¯
        startTrail(); // å¯åŠ¨æ‹–å°¾
    }

    // --- æ ¸å¿ƒé€»è¾‘ï¼šåº”ç”¨çŒ«å’ªæ•°æ® ---
    function applyCatType() {
        const data = catTypes[catIdx];
        catImg.src = data.src;
        // è®¾ç½®å…¨å±€å…‰æ™•é¢œè‰²å˜é‡ï¼Œç¿…è†€ã€æ‹–å°¾ã€ç‰¹æ•ˆéƒ½ä¼šå˜è‰²
        root.style.setProperty('--glow-color', data.glow);
        spawnBurst(catPos.x, catPos.y, 15, 'âœ¨'); // åˆ‡æ¢ç‰¹æ•ˆ
    }

    // --- æ ¸å¿ƒé€»è¾‘ï¼šåº”ç”¨èƒŒæ™¯ ---
    function applyBackground() {
        document.body.style.backgroundImage = `url('${backgrounds[bgIdx]}')`;
    }

    // --- æ¸¸æˆä¸»å¾ªç¯ (è´Ÿè´£å¹³æ»‘ç§»åŠ¨) ---
    function gameLoop() {
        if (!isBusy) {
            // ç®€å•çš„ç¼“åŠ¨è·Ÿéšé¼ æ ‡
            catPos.x += (targetPos.x - catPos.x) * 0.05;
            catPos.y += (targetPos.y - catPos.y) * 0.05;
            
            // é¢å‘åˆ¤æ–­
            if (targetPos.x < catPos.x) catContainer.classList.add('face-left');
            else catContainer.classList.remove('face-left');

            catContainer.style.left = catPos.x + 'px';
            catContainer.style.top = catPos.y + 'px';
        }
        requestAnimationFrame(gameLoop);
    }

    // --- äº¤äº’äº‹ä»¶ ---
    // é¼ æ ‡ç§»åŠ¨æ›´æ–°ç›®æ ‡ç‚¹
    document.addEventListener('mousemove', (e) => {
        if (!isBusy) {
            targetPos.x = e.clientX;
            targetPos.y = e.clientY;
        }
    });

    // ç‚¹å‡»çŒ«å’ª
    function clickCat(e) {
        e.stopPropagation();
        spawnBurst(e.clientX, e.clientY, 10, 'ğŸ’–');
        // ç¬ç§»ç‰¹æ•ˆï¼šæœ‰æ¦‚ç‡è§¦å‘
        if (Math.random() > 0.5 && !isBusy) teleportCat();
    }

    // --- æŒ‰é’®åŠŸèƒ½ ---
    // 1. æ¢çŒ«
    function changeCatType() {
        catIdx = (catIdx + 1) % catTypes.length;
        applyCatType();
    }
    // 2. æ¢èƒŒæ™¯
    function changeBackground() {
        bgIdx = (bgIdx + 1) % backgrounds.length;
        applyBackground();
    }
    // 3. å–‚é£Ÿ/ç©çƒ (æ ¸å¿ƒäº’åŠ¨å‡çº§)
    function dropItem(emoji, actionClass) {
        if (isBusy) return;
        isBusy = true; // æ ‡è®°ä¸ºå¿™ç¢Œï¼Œæš‚åœè·Ÿéšé¼ æ ‡

        // ç”Ÿæˆç‰©å“
        const item = document.createElement('div');
        item.className = 'item-drop';
        item.innerText = emoji;
        // åœ¨é¼ æ ‡ä½ç½®ç”Ÿæˆ
        const dropX = targetPos.x;
        const dropY = targetPos.y;
        item.style.left = dropX + 'px';
        item.style.top = dropY + 'px';
        document.body.appendChild(item);

        // çŒ«å’ªé£å‘ç‰©å“
        catPos.x = dropX;
        catPos.y = dropY;
        catContainer.style.left = catPos.x + 'px';
        catContainer.style.top = catPos.y + 'px';
        
        // åˆ°è¾¾åæ‰§è¡ŒåŠ¨ä½œ
        setTimeout(() => {
            catContainer.classList.add(actionClass); // æ·»åŠ åƒ/ç©åŠ¨ç”»ç±»
            spawnBurst(dropX, dropY, 8, emoji === 'ğŸŸ' ? 'ğŸ˜‹' : 'âœ¨');
            
            // åŠ¨ä½œæŒç»­ä¸€æ®µæ—¶é—´åæ¢å¤
            setTimeout(() => {
                catContainer.classList.remove(actionClass);
                item.remove();
                isBusy = false; // æ¢å¤è·Ÿéš
            }, 2000);
        }, 300);
    }

    // --- ç‰¹æ•ˆç³»ç»Ÿ ---
    // ç¬ç§»
    function teleportCat() {
        catContainer.classList.add('teleport-out');
        setTimeout(() => {
            // éšæœºç¬ç§»åˆ°å±å¹•æŸå¤„
            catPos.x = Math.random() * window.innerWidth;
            catPos.y = Math.random() * window.innerHeight;
            targetPos.x = catPos.x; targetPos.y = catPos.y; // é‡ç½®ç›®æ ‡ç‚¹é˜²æ­¢ç«‹åˆ»é£èµ°
            catContainer.style.left = catPos.x + 'px';
            catContainer.style.top = catPos.y + 'px';
            
            catContainer.classList.remove('teleport-out');
            catContainer.classList.add('teleport-in');
            setTimeout(() => catContainer.classList.remove('teleport-in'), 400);
        }, 400);
    }

    // æ‹–å°¾ç”Ÿæˆå™¨
    function startTrail() {
        setInterval(() => {
            if (isBusy) return; // å¿™ç¢Œæ—¶ä¸ç”Ÿæˆ
            const p = document.createElement('div'); p.className = 'trail';
            p.style.left = catPos.x + (Math.random()-0.5)*20 + 'px';
            p.style.top = catPos.y + (Math.random()-0.5)*20 + 'px';
            document.body.appendChild(p); setTimeout(() => p.remove(), 800);
        }, 40);
    }

    // çˆ†å‘ç²’å­
    function spawnBurst(x, y, count, char) {
        for(let i=0; i<count; i++) {
            const p = document.createElement('div'); p.className = 'burst-fx';
            p.innerText = char; p.style.left = x + 'px'; p.style.top = y + 'px';
            p.style.setProperty('--tx', (Math.random()-0.5)*200+'px');
            p.style.setProperty('--ty', (Math.random()-0.5)*200+'px');
            p.style.setProperty('--r', (Math.random()-0.5)*360+'deg');
            document.body.appendChild(p); setTimeout(() => p.remove(), 1000);
        }
    }
    
    // ç¯å¢ƒå°˜åŸƒ
    function generateDust() {
        for(let i=0; i<40; i++) {
            let d = document.createElement('div'); d.className = 'magic-dust';
            d.style.left = Math.random()*100+'vw'; 
            d.style.animationDelay = Math.random()*-10+'s';
            d.style.animationDuration = 10+Math.random()*20+'s';
            document.getElementById('dust-layer').appendChild(d);
        }
    }

    init();
</script>
</body>
</html>
