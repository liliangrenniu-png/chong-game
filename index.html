<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ˜Ÿæ„¿å¹»å…½ä¹‹æ£®ï¼šè§‰é†’</title>
    <style>
        :root { --primary: #6c5ce7; --secondary: #a29bfe; }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; font-family: "Segoe UI", "Microsoft YaHei", cursive; background: #000; user-select: none; }

        /* --- æ ¸å¿ƒèˆå°ä¸å…‰å½± --- */
        #stage { width: 100vw; height: 100vh; position: relative; overflow: hidden; }
        
        /* å…¨å±€å…‰æ•ˆï¼šä¸è¾¾å°”å…‰æŸ */
        .god-rays {
            position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
            background: repeating-conic-gradient(from 0deg, rgba(255,255,255,0.05) 0deg, rgba(255,255,255,0) 15deg, rgba(255,255,255,0.05) 30deg);
            animation: rotateRays 60s linear infinite; pointer-events: none; z-index: 20; mix-blend-mode: overlay;
        }
        /* ç¯å¢ƒç²’å­ */
        .particles { position: absolute; width: 100%; height: 100%; background-image: url('https://cdn.pixabay.com/photo/2016/11/29/05/45/astronomy-1867616_960_720.jpg'); opacity: 0.2; animation: drift 30s linear infinite; pointer-events: none; z-index: 15; mix-blend-mode: screen; }

        /* --- åœºæ™¯å®¹å™¨ --- */
        .scene-slider { 
            width: 300vw; height: 100%; display: flex; position: absolute; top: 0; left: 0; 
            transition: transform 1s cubic-bezier(0.22, 1, 0.36, 1); /* é«˜çº§ç¼“åŠ¨æ•ˆæœ */
        }
        .scene { position: relative; width: 100vw; height: 100%; overflow: hidden; }
        /* é«˜æ¸…èƒŒæ™¯å›¾å±‚ */
        .bg-layer { position: absolute; width: 110%; height: 110%; left: -5%; top: -5%; background-size: cover; background-position: center; transition: transform 1s ease-out; }

        /* åœºæ™¯1: æ°¸æ’ä¹‹æ£® */
        .s0 .bg-layer { background-image: url('https://picsum.photos/id/1015/1920/1080'); filter: hue-rotate(290deg) brightness(0.7); }
        /* åœºæ™¯2: å¤©ç©ºä¹‹åŸ */
        .s1 .bg-layer { background-image: url('https://picsum.photos/id/1024/1920/1080'); filter: hue-rotate(180deg) brightness(0.9); }
        /* åœºæ™¯3: æ·±æ¸Šç¥­å› */
        .s2 .bg-layer { background-image: url('https://picsum.photos/id/1039/1920/1080'); filter: hue-rotate(340deg) brightness(0.6); }

        /* --- é«˜çº§é­”å…½å®ä½“ --- */
        .beast-unit {
            position: absolute; width: 200px; height: 200px; cursor: pointer; z-index: 50;
            transition: all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.3s; /* Qå¼¹çš„å‡ºç°æ•ˆæœ */
        }
        .beast-unit.teleporting { transform: scale(0) rotate(180deg); opacity: 0; filter: blur(10px); }
        .beast-unit:hover .sprite-container { transform: scale(1.05) translateY(-10px); filter: brightness(1.1) drop-shadow(0 0 15px var(--glow-color)); }

        /* ç²¾çµå›¾å®¹å™¨ï¼šè´Ÿè´£æ ¸å¿ƒåŠ¨ç”» */
        .sprite-container {
            position: relative; width: 100%; height: 100%;
            animation: float-breath 4s ease-in-out infinite;
            filter: drop-shadow(0 5px 10px rgba(0,0,0,0.5));
            transition: 0.3s;
        }

        /* çœŸæ­£çš„ç¾æœ¯ç´ æ */
        .sprite-img { width: 100%; height: 100%; object-fit: contain; pointer-events: none; }

        /* --- åŠ¨ç”»å®šä¹‰ --- */
        @keyframes rotateRays { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes drift { from { background-position: 0 0; } to { background-position: 100px 50px; } }
        @keyframes float-breath { 0%, 100% { transform: translateY(0) scale(1); } 50% { transform: translateY(-15px) scale(1.02); } }

        /* --- ç°ä»£åŒ– UI --- */
        #hud { position: absolute; top: 30px; left: 30px; z-index: 100; }
        .glass-panel { 
            background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
            padding: 12px 24px; border-radius: 16px; color: white; font-weight: 600; 
            border: 1px solid rgba(255, 255, 255, 0.2); box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            display: flex; align-items: center; gap: 10px;
        }

        #controls { position: absolute; bottom: 40px; width: 100%; display: flex; justify-content: center; gap: 25px; z-index: 100; }
        .nav-btn { 
            width: 70px; height: 70px; border-radius: 24px; background: rgba(255,255,255,0.9);
            display: flex; align-items: center; justify-content: center; font-size: 32px; cursor: pointer;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3); transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1); border: none;
        }
        .nav-btn:hover { transform: translateY(-8px) scale(1.1); background: white; box-shadow: 0 15px 35px rgba(108, 92, 231, 0.4); }
        .hatch-btn { background: linear-gradient(135deg, #a1c4fd, #c2e9fb); color: #fff; font-size: 40px; }
    </style>
</head>
<body>

<div id="stage">
    <div class="god-rays"></div>
    <div class="particles"></div>

    <div class="scene-slider" id="world">
        <div class="scene s0"><div class="bg-layer"></div></div>
        <div class="scene s1"><div class="bg-layer"></div></div>
        <div class="scene s2"><div class="bg-layer"></div></div>
    </div>

    <div id="hud">
        <div class="glass-panel">
            <span style="font-size: 24px">ğŸ’</span> 
            <span style="font-size: 18px">æ˜Ÿæº: <span id="coin-txt">100</span></span>
        </div>
    </div>

    <div id="controls">
        <button class="nav-btn" onclick="switchScene(-1)">â—€ï¸</button>
        <button class="nav-btn hatch-btn" onclick="hatch()">ğŸ¥š</button>
        <button class="nav-btn" onclick="switchScene(1)">â–¶ï¸</button>
    </div>
</div>

<script>
    let coins = 100;
    let beasts = [];
    let currentSceneIdx = 0;

    // é«˜çº§é­”å…½å›¾é‰´ (ä½¿ç”¨å ä½ç¬¦ç¾æœ¯èµ„æºï¼Œå®é™…å¼€å‘ä¸­åº”æ›¿æ¢ä¸ºä»˜è´¹/è‡ªåˆ¶çš„é«˜æ¸…ç´ æ)
    // è¿™é‡Œä½¿ç”¨çš„æ˜¯ä¸€äº›å¼€æºé£æ ¼çš„å¥‡å¹»ç”Ÿç‰©æ¦‚å¿µå›¾é“¾æ¥ä½œä¸ºæ¼”ç¤º
    const BEAST_DATA = [
        { name: 'ç‚½ç„°ç‹®é¹«', src: 'https://cdn-icons-png.flaticon.com/512/2058/2058244.png', glow: '#ff5e57' },
        { name: 'æ·±æ¸Šé­”é¾™', src: 'https://cdn-icons-png.flaticon.com/512/2058/2058257.png', glow: '#a55eea' },
        { name: 'æ£®ä¹‹å¦–ç²¾', src: 'https://cdn-icons-png.flaticon.com/512/2058/2058250.png', glow: '#2bcbba' },
        { name: 'æ˜Ÿç©ºæ°´çµ', src: 'https://cdn-icons-png.flaticon.com/512/2058/2058197.png', glow: '#45aaf2' }
    ];

    class HighEndBeast {
        constructor() {
            this.data = BEAST_DATA[Math.floor(Math.random() * BEAST_DATA.length)];
            this.sceneLocation = currentSceneIdx;
            // éšæœºä½ç½®ï¼Œé¿å¼€è¾¹ç¼˜
            this.x = Math.random() * (window.innerWidth - 250) + 25;
            this.y = Math.random() * (window.innerHeight - 350) + 100;
            this.render();
            this.startAI();
        }

        render() {
            this.el = document.createElement('div');
            this.el.className = 'beast-unit';
            // è®¾ç½® CSS å˜é‡ç”¨äºé¼ æ ‡æ‚¬åœå‘å…‰è‰²
            this.el.style.setProperty('--glow-color', this.data.glow);
            this.el.innerHTML = `
                <div class="sprite-container">
                    <img src="${this.data.src}" class="sprite-img" alt="${this.data.name}">
                </div>
            `;
            this.el.onclick = () => this.interact();
            this.updateVisibility();
            document.getElementById('stage').appendChild(this.el);
            
            // å…¥åœºåŠ¨ç”»
            this.el.style.transform = `translate(${this.x}px, ${this.y}px) scale(0)`;
            setTimeout(() => {
                this.el.style.transform = `translate(${this.x}px, ${this.y}px) scale(1)`;
            }, 50);
        }

        updateVisibility() {
            this.el.style.left = '0'; // ä½ç½®ç”± transform æ§åˆ¶
            this.el.style.top = '0';
            this.el.style.transform = `translate(${this.x}px, ${this.y}px)`;

            const isVisible = (this.sceneLocation === currentSceneIdx);
            this.el.style.opacity = isVisible ? 1 : 0;
            this.el.style.pointerEvents = isVisible ? 'auto' : 'none';
            // å¦‚æœä¸å¯è§ï¼Œç¨å¾®ç¼©å°ä¸€ç‚¹ï¼Œè®©å‡ºç°æ—¶æœ‰å¼¹å‡ºçš„æ„Ÿè§‰
            if (!isVisible) this.el.style.transform += ' scale(0.8)';
        }

        interact() {
            coins += 5; updateUI();
            const sprite = this.el.querySelector('.sprite-container');
            // ç‚¹å‡»åé¦ˆåŠ¨ç”»ï¼šå‰§çƒˆå¼¹è·³
            sprite.style.animation = 'none';
            setTimeout(() => sprite.style.animation = 'float-breath 0.4s ease-out', 10);
            setTimeout(() => sprite.style.animation = 'float-breath 4s ease-in-out infinite', 410);
            this.spawnFX('âœ¨');
        }

        startAI() {
            setInterval(() => {
                if (Math.random() > 0.65) this.teleport();
                else this.wander();
            }, 3500 + Math.random() * 2000);
        }

        wander() {
            this.x += (Math.random() - 0.5) * 200;
            this.y += (Math.random() - 0.5) * 150;
            // è¾¹ç•Œé™åˆ¶
            this.x = Math.max(25, Math.min(window.innerWidth - 225, this.x));
            this.y = Math.max(100, Math.min(window.innerHeight - 300, this.y));
            this.updateVisibility();
        }

        teleport() {
            this.el.classList.add('teleporting');
            this.spawnFX('ğŸŒ€', 100);
            setTimeout(() => {
                let newScene = Math.floor(Math.random() * 3);
                while(newScene === this.sceneLocation) newScene = Math.floor(Math.random() * 3);
                this.sceneLocation = newScene;
                this.x = Math.random() * (window.innerWidth - 250) + 25;
                this.updateVisibility();
                
                setTimeout(() => {
                    this.el.classList.remove('teleporting');
                    if(this.sceneLocation === currentSceneIdx) this.spawnFX('âš¡', 150);
                }, 300);
            }, 400);
        }

        spawnFX(emoji, offset=0) {
            const fx = document.createElement('div');
            fx.innerText = emoji; fx.style.position = 'absolute'; fx.style.fontSize = '50px';
            fx.style.left = this.x + 75 + 'px'; fx.style.top = this.y - offset + 'px';
            fx.style.zIndex = 200; fx.style.animation = 'float-breath 1s ease-out forwards';
            fx.style.opacity = 0.8;
            document.getElementById('stage').appendChild(fx);
            setTimeout(() => fx.remove(), 1000);
        }
    }

    function updateUI() { document.getElementById('coin-txt').innerText = coins; }

    function switchScene(dir) {
        currentSceneIdx = (currentSceneIdx + dir + 3) % 3;
        document.getElementById('world').style.transform = `translateX(-${currentSceneIdx * 100}vw)`;
        
        // è§†å·®æ»šåŠ¨æ•ˆæœï¼šèƒŒæ™¯å±‚ç§»åŠ¨é€Ÿåº¦è¾ƒæ…¢
        document.querySelectorAll('.bg-layer').forEach((bg, idx) => {
            const relativePos = idx - currentSceneIdx;
            bg.style.transform = `translateX(${relativePos * 10}%) scale(1.1)`;
        });

        beasts.forEach(b => b.updateVisibility());
    }

    function hatch() {
        if(coins >= 50) {
            coins -= 50; updateUI();
            beasts.push(new HighEndBeast());
            // æŒ‰é’®ç‚¹å‡»åé¦ˆ
            const btn = document.querySelector('.hatch-btn');
            btn.style.transform = 'scale(0.9)';
            setTimeout(() => btn.style.transform = '', 150);
        } else {
            alert("éœ€è¦ 50 æ˜Ÿæºæ‰èƒ½å¬å”¤é«˜çº§é­”å…½ï¼");
        }
    }

    // åˆå§‹å¬å”¤
    beasts.push(new HighEndBeast());
    updateUI();
</script>
</body>
</html>
