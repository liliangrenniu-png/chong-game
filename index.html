<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ¢¦å¹»ç²¾çµçŒ«ï¼šé­”æ³•è¿½é€</title>
    <style>
        /* --- 1. æ¢¦å¹»åœºæ™¯ --- */
        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden;
            /* æ·±è‰²é­”æ³•æ£®æ—èƒŒæ™¯ */
            background: radial-gradient(circle at bottom, #1a0f2e 0%, #090510 100%);
            font-family: "å¹¼åœ†", cursive; user-select: none;
        }
        
        /* èƒŒæ™¯æ¼‚æµ®çš„å…‰ç‚¹ */
        .ambient-particle {
            position: absolute; background: white; border-radius: 50%;
            box-shadow: 0 0 10px #fff, 0 0 20px #a855ff;
            opacity: 0.3; animation: float-ambient 10s linear infinite;
        }
        @keyframes float-ambient { from { transform: translateY(0); } to { transform: translateY(-100vh); } }

        /* é­”æ³•å…‰çƒæ¨¡å¼çš„å…‰æ ‡ */
        body.magic-mode { cursor: none; }
        #magic-orb {
            position: absolute; width: 20px; height: 20px; background: #00f7ff; border-radius: 50%;
            box-shadow: 0 0 15px #00f7ff, 0 0 30px #a855ff, inset 0 0 10px white;
            pointer-events: none; z-index: 100; display: none; mix-blend-mode: screen;
            transform: translate(-50%, -50%); animation: orb-pulse 1s infinite alternate;
        }
        @keyframes orb-pulse { from { transform: translate(-50%, -50%) scale(1); } to { transform: translate(-50%, -50%) scale(1.2); } }

        /* --- 2. ä¸»è§’ï¼šç²¾çµçŒ« --- */
        #cat-container {
            position: absolute; left: 50%; top: 50%;
            width: 160px; height: 160px;
            /* é”šç‚¹æ”¹åˆ°ä¸­å¿ƒï¼Œé€‚åˆé£è¡Œå’Œç¬ç§» */
            transform-origin: center center;
            transition: left 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94), top 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            z-index: 20; cursor: grab;
        }

        /* ç²¾çµç¿…è†€å±‚ */
        .wings-layer {
            position: absolute; top: 20%; left: -10%; width: 120%; height: 60%;
            display: flex; justify-content: space-between; z-index: -1;
            opacity: 0.8; mix-blend-mode: screen;
        }
        .wing {
            width: 50px; height: 80px;
            background: rgba(200, 255, 255, 0.5);
            border-radius: 50% 50% 0 50%;
            box-shadow: 0 0 15px #00f7ff;
            filter: blur(2px);
        }
        .wing.left { transform-origin: right center; animation: flap-l 0.1s infinite alternate; }
        .wing.right { transform: scaleX(-1); transform-origin: left center; animation: flap-r 0.1s infinite alternate; }
        @keyframes flap-l { from { transform: rotate(10deg) scaleY(1); } to { transform: rotate(-20deg) scaleY(0.8); } }
        @keyframes flap-r { from { transform: scaleX(-1) rotate(10deg) scaleY(1); } to { transform: scaleX(-1) rotate(-20deg) scaleY(0.8); } }


        /* çŒ«å’ªæœ¬ä½“å±‚ */
        .cat-sprite {
            width: 100%; height: 100%;
            background-image: url('https://i.pinimg.com/originals/08/43/d4/0843d40ae137e0ba7b56c03bc6681c84.png');
            background-size: contain; background-repeat: no-repeat; background-position: center;
            /* æ‚¬æµ®åŠ¨ç”» å’Œ é­”æ³•è§å…‰æ»¤é•œ */
            animation: float-cat 2s ease-in-out infinite;
            filter: drop-shadow(0 0 15px #00f7ff) brightness(1.1);
            transition: transform 0.3s;
        }

        @keyframes float-cat { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }

        /* ç¬ç§»åŠ¨ç”» */
        .teleporting-out { animation: teleport-out 0.3s forwards !important; }
        .teleporting-in { animation: teleport-in 0.3s forwards !important; }
        @keyframes teleport-out { to { transform: scale(0) rotate(360deg); opacity: 0; filter: brightness(3) blur(10px); } }
        @keyframes teleport-in { from { transform: scale(3); opacity: 0; filter: brightness(3) blur(10px); } to { transform: scale(1); opacity: 1; } }

        /* ç‚¹å‡»æ–½æ³•åé¦ˆ */
        .cast-spell { animation: spell-anim 0.4s !important; }
        @keyframes spell-anim { 0% { transform: scale(1); filter: brightness(1); } 50% { transform: scale(1.3); filter: brightness(2) hue-rotate(180deg); } 100% { transform: scale(1); } }

        .face-left { transform: scaleX(-1); }

        /* --- 3. ç‰¹æ•ˆç²’å­ --- */
        /* ç§»åŠ¨æ‹–å°¾ */
        .trail-particle {
            position: absolute; width: 10px; height: 10px; background: #00f7ff;
            border-radius: 50%; pointer-events: none; z-index: 15;
            box-shadow: 0 0 10px #a855ff; mix-blend-mode: screen;
            animation: fade-trail 0.8s ease-out forwards;
        }
        @keyframes fade-trail { to { transform: scale(0.2); opacity: 0; } }

        /* ç‚¹å‡»çˆ†ç‚¸ç²’å­ */
        .magic-burst {
            position: absolute; font-size: 24px; pointer-events: none; z-index: 30;
            animation: burst-anim 1s ease-out forwards; color: #00f7ff;
            text-shadow: 0 0 5px #fff;
        }
        @keyframes burst-anim {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 1; }
            100% { transform: translate(var(--tx), var(--ty)) scale(0) rotate(var(--r)); opacity: 0; }
        }
        
        /* --- 4. UI --- */
        #controls {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%); z-index: 50;
        }
        .btn {
            background: rgba(0,0,0,0.5); padding: 12px 25px; border-radius: 30px;
            box-shadow: 0 0 20px #a855ff; font-weight: bold; color: #00f7ff;
            cursor: pointer; border: 2px solid #00f7ff; transition: 0.3s;
            backdrop-filter: blur(5px); text-shadow: 0 0 5px #00f7ff;
        }
        .btn:hover { background: rgba(0, 247, 255, 0.2); transform: scale(1.05); }
        .btn.active { background: #00f7ff; color: #1a0f2e; box-shadow: 0 0 30px #00f7ff; }

    </style>
</head>
<body>

    <div id="ambient-container"></div>
    <div id="magic-orb"></div>

    <div id="cat-container" onclick="petCat(event)">
        <div class="wings-layer">
            <div class="wing left"></div>
            <div class="wing right"></div>
        </div>
        <div class="cat-sprite" id="cat-visual"></div>
    </div>

    <div id="controls">
        <div class="btn" id="magic-btn" onclick="toggleMagicMode()">âœ¨ å¬å”¤é­”æ³•å…‰çƒ</div>
    </div>

<script>
    const catContainer = document.getElementById('cat-container');
    const catVisual = document.getElementById('cat-visual');
    const magicOrb = document.getElementById('magic-orb');
    const magicBtn = document.getElementById('magic-btn');
    let isMagicMode = false;
    let isMoving = false;
    let trailTimer = null;

    let catPos = { x: window.innerWidth / 2, y: window.innerHeight / 2 };
    updateCatPos();

    // ç”ŸæˆèƒŒæ™¯æ°›å›´
    for(let i=0; i<30; i++) {
        let p = document.createElement('div'); p.className = 'ambient-particle';
        p.style.left = Math.random()*100+'vw'; p.style.top = Math.random()*100+'vh';
        p.style.width = p.style.height = Math.random()*5+'px';
        p.style.animationDelay = Math.random()*-10+'s';
        p.style.animationDuration = 10+Math.random()*20+'s';
        document.getElementById('ambient-container').appendChild(p);
    }

    // --- æ ¸å¿ƒäº¤äº’ï¼šé¼ æ ‡/å…‰çƒè·Ÿéš ---
    document.addEventListener('mousemove', (e) => {
        if (isMagicMode) {
            magicOrb.style.left = e.clientX + 'px';
            magicOrb.style.top = e.clientY + 'px';
            // é­”æ³•æ¨¡å¼ä¸‹ï¼ŒçŒ«å’ªå°è¯•è¿½é€
            if (!isMoving) chaseTarget(e.clientX, e.clientY);
        } else {
            faceTarget(e.clientX);
        }
    });

    document.addEventListener('mousedown', (e) => {
        if (e.target.closest('.btn') || e.target.closest('#cat-container')) return;
        if (!isMagicMode && !isMoving) {
            chaseTarget(e.clientX, e.clientY);
            spawnBurst(e.clientX, e.clientY, 1, 'âœ¨');
        }
    });

    // --- æ ¸å¿ƒäº¤äº’ï¼šç‚¹å‡»æ–½æ³• (æ›¿ä»£æŠšæ‘¸) ---
    function petCat(e) {
        e.stopPropagation();
        // è§†è§‰åé¦ˆï¼šæ–½æ³•çˆ†å‘
        catVisual.classList.remove('float-cat');
        void catVisual.offsetWidth;
        catVisual.classList.add('cast-spell');
        
        spawnBurst(e.clientX, e.clientY, 8, ['âœ¨', 'âš¡', 'â­', 'ğŸ’ '][Math.floor(Math.random()*4)]);

        setTimeout(() => {
            catVisual.classList.remove('cast-spell');
        }, 400);
    }

    // --- åŠŸèƒ½ï¼šåˆ‡æ¢é­”æ³•æ¨¡å¼ ---
    function toggleMagicMode() {
        isMagicMode = !isMagicMode;
        document.body.classList.toggle('magic-mode', isMagicMode);
        magicOrb.style.display = isMagicMode ? 'block' : 'none';
        magicBtn.classList.toggle('active', isMagicMode);
        // é­”æ³•æ¨¡å¼é€Ÿåº¦æ›´å¿«
        catContainer.style.transitionDuration = isMagicMode ? '0.2s' : '0.4s';
    }

    // --- åŠ¨ä½œé€»è¾‘ï¼šè¿½é€ä¸ç¬ç§» ---
    function chaseTarget(x, y) {
        isMoving = true;
        faceTarget(x);

        // é­”æ³•æ¨¡å¼ä¸‹æœ‰ 30% æ¦‚ç‡è§¦å‘ç¬ç§»
        if (isMagicMode && Math.random() > 0.7) {
            performTeleport(x, y);
        } else {
            // æ™®é€šé£è¡Œè¿½é€
            startTrail(); // å¼€å§‹ç”Ÿæˆæ‹–å°¾
            catPos.x = x - 80; catPos.y = y - 80;
            updateCatPos();
            // ç§»åŠ¨ç»“æŸååœæ­¢çŠ¶æ€
            setTimeout(() => {
                isMoving = false;
                stopTrail();
            }, isMagicMode ? 200 : 400);
        }
    }

    // ç¬ç§»åŠ¨ä½œ
    function performTeleport(x, y) {
        stopTrail();
        // æ¶ˆå¤±åŠ¨ç”»
        catVisual.classList.add('teleporting-out');
        spawnBurst(catPos.x+80, catPos.y+80, 10, 'ğŸ’¨'); // åŸåœ°ç•™ä¸‹çƒŸé›¾
        
        setTimeout(() => {
            // ç¬é—´ç§»åŠ¨åæ ‡
            catPos.x = x - 80; catPos.y = y - 80;
            catContainer.style.transition = 'none'; // å…³é—­è¿‡æ¸¡ä»¥å®ç°ç¬ç§»
            updateCatPos();
            
            // å‡ºç°åŠ¨ç”»
            catVisual.classList.remove('teleporting-out');
            catVisual.classList.add('teleporting-in');
            spawnBurst(x, y, 10, 'âš¡'); // ç›®çš„åœ°çˆ†å‘å‡ºé—ªç”µ

            setTimeout(() => {
                catVisual.classList.remove('teleporting-in');
                catContainer.style.transition = ''; // æ¢å¤è¿‡æ¸¡
                isMoving = false;
            }, 300);
        }, 300);
    }

    function faceTarget(targetX) {
        const catRect = catContainer.getBoundingClientRect();
        if (targetX < catRect.left + catRect.width / 2) {
            catVisual.classList.add('face-left');
        } else {
            catVisual.classList.remove('face-left');
        }
    }

    function updateCatPos() {
        catContainer.style.left = catPos.x + 'px';
        catContainer.style.top = catPos.y + 'px';
    }

    // --- ç‰¹æ•ˆå·¥å…· ---
    // ç”Ÿæˆæ‹–å°¾
    function startTrail() {
        if(trailTimer) return;
        trailTimer = setInterval(() => {
            const rect = catContainer.getBoundingClientRect();
            const p = document.createElement('div');
            p.className = 'trail-particle';
            // åœ¨çŒ«å’ªä¸­å¿ƒç¨å¾®éšæœºä¸€ç‚¹çš„ä½ç½®ç”Ÿæˆ
            p.style.left = rect.left + rect.width/2 + (Math.random()-0.5)*20 + 'px';
            p.style.top = rect.top + rect.height/2 + (Math.random()-0.5)*20 + 'px';
            document.body.appendChild(p);
            setTimeout(() => p.remove(), 800);
        }, 50); // æ¯50msç”Ÿæˆä¸€ä¸ªç²’å­
    }
    function stopTrail() {
        clearInterval(trailTimer);
        trailTimer = null;
    }

    // ç”Ÿæˆçˆ†ç‚¸ç²’å­
    function spawnBurst(x, y, count, char) {
        for(let i=0; i<count; i++) {
            const p = document.createElement('div'); p.className = 'magic-burst';
            p.innerText = Array.isArray(char) ? char[Math.floor(Math.random()*char.length)] : char;
            p.style.left = x + 'px'; p.style.top = y + 'px';
            const tx = (Math.random() - 0.5) * 200 + 'px';
            const ty = (Math.random() - 0.5) * 200 + 'px';
            const r = (Math.random() - 0.5) * 360 + 'deg';
            p.style.setProperty('--tx', tx); p.style.setProperty('--ty', ty); p.style.setProperty('--r', r);
            document.body.appendChild(p); setTimeout(() => p.remove(), 1000);
        }
    }

</script>
</body>
</html>
