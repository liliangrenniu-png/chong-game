<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è¶…èŒå–µå‘œï¼šæ¡Œé¢äº’åŠ¨å°å¥¶çŒ«</title>
    <style>
        /* --- 1. æ¸©é¦¨çš„åœºæ™¯ --- */
        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden;
            /* æŸ”å’Œçš„å¥¶æ²¹è‰²èƒŒæ™¯+æ³¢ç‚¹çº¹ç† */
            background-color: #fffefa;
            background-image: radial-gradient(#f3e5d0 2px, transparent 2px);
            background-size: 20px 20px;
            font-family: "å¹¼åœ†", cursive; user-select: none;
        }
        
        /* æ¿€å…‰ç¬”å…‰æ ‡æ ·å¼ */
        body.laser-mode {
            cursor: none; /* éšè—é»˜è®¤é¼ æ ‡ */
        }

        /* æ¿€å…‰çº¢ç‚¹ */
        #laser-dot {
            position: absolute; width: 12px; height: 12px; background: red; border-radius: 50%;
            box-shadow: 0 0 10px red, 0 0 20px #ff5555;
            pointer-events: none; z-index: 100; display: none;
            transform: translate(-50%, -50%);
        }

        /* --- 2. ä¸»è§’ï¼šè¶…èŒå°å¥¶çŒ« --- */
        #cat-container {
            position: absolute; left: 50%; top: 50%;
            width: 150px; height: 150px;
            /* é”šç‚¹è®¾ç½®åœ¨åº•éƒ¨ä¸­å¿ƒï¼Œæ–¹ä¾¿è·³è·ƒå’Œç¿»è½¬ */
            transform-origin: bottom center;
            transition: left 0.3s ease-out, top 0.3s ease-out, transform 0.2s;
            z-index: 10; cursor: grab;
        }

        /* çŒ«å’ªå›¾ç‰‡å±‚ (è´Ÿè´£åŠ¨ç”»å’Œç¿»è½¬) */
        .cat-sprite {
            width: 100%; height: 100%;
            /* ä½¿ç”¨ä¸€å¼ é«˜è´¨é‡ã€æ¯›èŒ¸èŒ¸çš„å¯çˆ±å°çŒ«ç´ æ */
            background-image: url('https://i.pinimg.com/originals/08/43/d4/0843d40ae137e0ba7b56c03bc6681c84.png');
            background-size: contain; background-repeat: no-repeat; background-position: bottom center;
            /* æŸ”å’Œçš„å‘¼å¸åŠ¨ç”»å’ŒæŠ•å½± */
            animation: breathe 2s ease-in-out infinite;
            filter: drop-shadow(0 5px 10px rgba(0,0,0,0.1));
            transition: transform 0.3s;
        }

        /* å‘¼å¸åŠ¨ç”» */
        @keyframes breathe { 0%, 100% { transform: scaleY(1); } 50% { transform: scaleY(1.03); } }
        
        /* è·³æ‰‘åŠ¨ä½œ */
        .pouncing { animation: pounce-anim 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important; }
        @keyframes pounce-anim {
            0% { transform: scaleY(0.8); } /* è“„åŠ› */
            40% { transform: translateY(-100px) scaleY(1.1); } /* è·³èµ· */
            100% { transform: translateY(0) scaleY(1); } /* è½åœ° */
        }

        /* Qå¼¹æŠšæ‘¸åé¦ˆ */
        .squish { animation: squish-anim 0.3s !important; }
        @keyframes squish-anim { 50% { transform: scale(1.2, 0.8); } }

        /* å‘å·¦ç¿»è½¬ */
        .face-left { transform: scaleX(-1); }


        /* --- 3. äº¤äº’UIä¸ç‰¹æ•ˆ --- */
        /* æ§åˆ¶æŒ‰é’®æ  */
        #controls {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            display: flex; gap: 20px; z-index: 50;
        }
        .btn {
            background: #fff; padding: 10px 20px; border-radius: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1); font-weight: bold; color: #7d5a5a;
            cursor: pointer; border: 3px solid #f3e5d0; transition: 0.2s; display: flex; align-items: center; gap: 5px;
        }
        .btn:hover { transform: translateY(-3px); background: #fff5e6; }
        .btn.active { background: #ffadad; color: white; border-color: #ff6b6b; box-shadow: 0 0 15px #ff6b6b; }

        /* çˆ±å¿ƒç²’å­ */
        .heart-particle {
            position: absolute; font-size: 24px; pointer-events: none; z-index: 20;
            animation: float-heart 1s ease-out forwards; color: #ff6b6b;
        }
        @keyframes float-heart {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 1; }
            100% { transform: translate(var(--tx), -150px) scale(1.5) rotate(var(--r)); opacity: 0; }
        }
        
        /* æç¤ºæ–‡å­— */
        #hint { position: absolute; top: 20px; width: 100%; text-align: center; color: #aaa; }

    </style>
</head>
<body>

    <div id="hint">ç§»åŠ¨é¼ æ ‡é€—çŒ«ï¼Œç‚¹å‡»åœ°é¢è·³æ‰‘ï¼Œç‚¹å‡»çŒ«å’ªæŠšæ‘¸</div>
    <div id="laser-dot"></div>

    <div id="cat-container" onclick="petCat(event)">
        <div class="cat-sprite" id="cat-visual"></div>
    </div>

    <div id="controls">
        <div class="btn" id="laser-btn" onclick="toggleLaserMode()">ğŸ”´ æ¿€å…‰ç¬”æ¨¡å¼</div>
    </div>

<script>
    const catContainer = document.getElementById('cat-container');
    const catVisual = document.getElementById('cat-visual');
    const laserDot = document.getElementById('laser-dot');
    const laserBtn = document.getElementById('laser-btn');
    let isLaserMode = false;
    let isPouncing = false;

    // åˆå§‹åŒ–çŒ«å’ªä½ç½®åœ¨ä¸­å¿ƒ
    let cat Pos = { x: window.innerWidth / 2, y: window.innerHeight / 2 };
    updateCatPos();

    // --- æ ¸å¿ƒäº¤äº’ 1ï¼šé¼ æ ‡è·Ÿéš (è®©çŒ«å’ªç›¯ç€ä½ çœ‹) ---
    document.addEventListener('mousemove', (e) => {
        // æ›´æ–°æ¿€å…‰ç‚¹ä½ç½®
        if (isLaserMode) {
            laserDot.style.left = e.clientX + 'px';
            laserDot.style.top = e.clientY + 'px';
            // æ¿€å…‰æ¨¡å¼ä¸‹ï¼ŒçŒ«å’ªè‡ªåŠ¨è¿½é€
            if (!isPouncing) pounceTo(e.clientX, e.clientY);
        } else {
            // æ™®é€šæ¨¡å¼ä¸‹ï¼ŒçŒ«å’ªåªæ˜¯é¢å‘é¼ æ ‡
            faceMouse(e.clientX);
        }
    });

    // --- æ ¸å¿ƒäº¤äº’ 2ï¼šç‚¹å‡»åœ°é¢è·³æ‰‘ ---
    document.addEventListener('mousedown', (e) => {
        // å¦‚æœç‚¹çš„æ˜¯æŒ‰é’®æˆ–çŒ«æœ¬èº«ï¼Œä¸è§¦å‘è·³æ‰‘
        if (e.target.closest('.btn') || e.target.closest('#cat-container')) return;
        
        // æ™®é€šæ¨¡å¼ä¸‹ç‚¹å‡»åœ°é¢ï¼ŒçŒ«å’ªè·³è¿‡å»
        if (!isLaserMode && !isPouncing) {
            pounceTo(e.clientX, e.clientY);
            spawnHearts(e.clientX, e.clientY, 1, 'ğŸ¾'); // ç”Ÿæˆçˆªå°
        }
    });

    // --- æ ¸å¿ƒäº¤äº’ 3ï¼šæŠšæ‘¸çŒ«å’ª (Qå¼¹åé¦ˆ) ---
    function petCat(e) {
        e.stopPropagation(); // é˜»æ­¢å†’æ³¡è§¦å‘è·³æ‰‘
        // è§†è§‰åé¦ˆï¼šQå¼¹æŒ¤å‹
        catVisual.classList.remove('breathe'); // æš‚æ—¶ç§»é™¤å‘¼å¸ä»¥æ’­æ”¾æŒ¤å‹
        void catVisual.offsetWidth; // å¼ºåˆ¶é‡ç»˜
        catVisual.classList.add('squish');
        
        // çˆ†å‡ºçˆ±å¿ƒ
        spawnHearts(e.clientX, e.clientY, 5, 'ğŸ’–');

        // æ¢å¤å‘¼å¸åŠ¨ç”»
        setTimeout(() => {
            catVisual.classList.remove('squish');
        }, 300);
    }

    // --- åŠŸèƒ½ï¼šåˆ‡æ¢æ¿€å…‰ç¬”æ¨¡å¼ ---
    function toggleLaserMode() {
        isLaserMode = !isLaserMode;
        document.body.classList.toggle('laser-mode', isLaserMode);
        laserDot.style.display = isLaserMode ? 'block' : 'none';
        laserBtn.classList.toggle('active', isLaserMode);
        
        // åˆ‡æ¢çŒ«å’ªçš„ç§»åŠ¨é€Ÿåº¦
        catContainer.style.transitionDuration = isLaserMode ? '0.1s' : '0.3s';
    }

    // --- åŠ¨ä½œé€»è¾‘ ---
    // é¢å‘é¼ æ ‡æ–¹å‘
    function faceMouse(mouseX) {
        const catRect = catContainer.getBoundingClientRect();
        const catCenterX = catRect.left + catRect.width / 2;
        
        if (mouseX < catCenterX) {
            catVisual.classList.add('face-left');
        } else {
            catVisual.classList.remove('face-left');
        }
    }

    // è·³æ‰‘åˆ°æŒ‡å®šä½ç½®
    function pounceTo(x, y) {
        isPouncing = true;
        // å…ˆé¢å‘ç›®æ ‡
        faceMouse(x);
        
        // æ’­æ”¾è·³æ‰‘åŠ¨ç”» (èº«ä½“è“„åŠ›è·³èµ·)
        catVisual.classList.add('pouncing');
        
        // ç§»åŠ¨ä½ç½® (å‡å»è‡ªèº«å®½é«˜çš„ä¸€åŠä»¥ä¸­å¿ƒå¯¹é½)
        catPos.x = x - 75;
        catPos.y = y - 130; // é”šç‚¹åœ¨åº•éƒ¨ï¼Œç¨å¾®å‘ä¸Šä¿®æ­£ä¸€ç‚¹è§†è§‰ä¸­å¿ƒ
        updateCatPos();

        // åŠ¨ç”»ç»“æŸåçŠ¶æ€æ¢å¤
        setTimeout(() => {
            catVisual.classList.remove('pouncing');
            isPouncing = false;
        }, 500);
    }

    function updateCatPos() {
        catContainer.style.left = catPos.x + 'px';
        catContainer.style.top = catPos.y + 'px';
    }

    // --- ç‰¹æ•ˆå·¥å…· ---
    function spawnHearts(x, y, count, emoji) {
        for(let i=0; i<count; i++) {
            const p = document.createElement('div');
            p.className = 'heart-particle';
            p.innerText = emoji;
            p.style.left = x + 'px'; p.style.top = y + 'px';
            const tx = (Math.random() - 0.5) * 100 + 'px';
            const r = (Math.random() - 0.5) * 90 + 'deg';
            p.style.setProperty('--tx', tx); p.style.setProperty('--r', r);
            document.body.appendChild(p);
            setTimeout(() => p.remove(), 1000);
        }
    }

</script>
</body>
</html>
